#
## Day 7 :  ì‚¬ìš©ì ê³„ì • ê´€ë¦¬ ë° ê¶Œí•œ ê¸°ë°˜ ìš”ì²­ ì œí•œ(Talend ê¸°ë°˜)
* ê°•ì˜ ëª©í‘œ  
ì‚¬ìš©ì ì—”í‹°í‹° ì„¤ê³„ ë° íšŒì›ê°€ì… API êµ¬í˜„  
Spring Securityë¥¼ í†µí•œ ê¶Œí•œ(Role) ë¶€ì—¬ ë° ë³´í˜¸ API ì„¤ì •  
Talendë¥¼ í†µí•´ ì‚¬ìš©ì ê¶Œí•œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦  
  
* ê°•ì˜ ë‚´ìš©  
1. ì‚¬ìš©ì ì—”í‹°í‹° ë° íšŒì›ê°€ì… API ì„¤ê³„  
2. ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” ì²˜ë¦¬(BCryptPasswordEncoder)  
3. Spring Securityì—ì„œ ê¶Œí•œ ë¶€ì—¬ ë° URL ë³´í˜¸ ì„¤ì •  
4. Talendë¥¼ í†µí•´ ì—­í• ë³„ ì ‘ê·¼ ì œí•œ í…ŒìŠ¤íŠ¸  
  
* ì‹¤ìŠµ ì½”ë“œ : íšŒì›ê°€ì… ë° ê¶Œí•œ ì„¤ì •  
User.java

        package com.example.jwt.model;
        @Entity
        public class User{
          private Long id;
          private String username;
          private String password;
          private String role; //ROLE_USER, ROLE_ADMIN
          //getters/setters
        }

* UserRepository.java

        package com.example.jwt.repository;
        import com.exmaple.jwt.model.User;
        import org.springframework.data.jpa.repoistory.JpaReository;
        import java.util.Optional;

        public interface UserRepository extends JpaRepository<User, Long>{
          Optional<User> findByUsername(String username);
        }

* RegisterRequest.java

        package com.example.jwt.dto;
        public class RegisterRequest{
          private String username;
          private String password;
          private String role; //ROLE_UER or ROLE_ADMIN
          //getters/setters
        }

* AuthController.java(íšŒì›ê°€ì… ì¶”ê°€)

        @PostMapping("/register")
        public ResponseEntity<?> register(@RequestBody RegisterRequest request){
          String ecodedPw = passwordEncoder.encode(request.getPassword());

          User user = new User();
          user .setUsername(request.getUername());
          user.setPassword(encodedPw)
          user.setRole(request.getRole)
          userRepository.save(user);

          return ResponseEntity.ok("íšŒì›ê°€ì… ì™„ë£Œ");
        }

* SecurityConfig.java(ê¶Œí•œë³„ ì ‘ê·¼ ì„¤ì •)

        public SecurityFilterChain filterChain(HttpSecurity http) throws Exception{
          http.csrf().disable()
              .authorizeHttpRequests()
              .requestMatchers("/auth/**").permitAll()
              .requestMatchers("/admin/**").hasRole("ADMIN")
              .anyRequest().authenticated()
              .and()
              .addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class);
          return http.build();
        }

* ì˜ˆì‹œ : Adminì „ìš© API

        @GetMapping("/admin/dashboard")
        public ResponseEntity<String> adminDashboard(){
          reutrn ResponseEntity.ok("ê´€ë¦¬ì í˜ì´ì§€ì…ë‹ˆë‹¤.");
        }

* Day 7 ê³¼ì œ

ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡° ìš”ì•½

        com.example.jwt
        â”œâ”€â”€ JwtApplication.java
        â”œâ”€â”€ controller
        â”‚   â””â”€â”€ AuthController.java
        â”‚   â””â”€â”€ AdminController.java
        â”œâ”€â”€ dto
        â”‚   â””â”€â”€ RegisterRequest.java
        â”‚   â””â”€â”€ LoginRequest.java
        â”œâ”€â”€ model
        â”‚   â””â”€â”€ User.java
        â”œâ”€â”€ repository
        â”‚   â””â”€â”€ UserRepository.java
        â”œâ”€â”€ config
        â”‚   â””â”€â”€ SecurityConfig.java
        â”œâ”€â”€ util
        â”‚   â””â”€â”€ JwtUtil.java
        â”œâ”€â”€ filter
        â”‚   â””â”€â”€ JwtAuthenticationFilter.java


1. /auth/registerë¥¼ í†µí•´  Talendë¡œ ì‚¬ìš©ì 2ëª… ë“±ë¡ : USER, ADMIN ê¶Œí•œ ê°ê° ë¶€ì—¬

2. ë¡œê·¸ì¸í•˜ì—¬ JWT í† í° ë°œê¸‰ --> Authorization í—¤ë”ë¡œ /admin/dashboard ìš”ì²­ í…ŒìŠ¤íŠ¸

3. ROLE_USER ê³„ì •ì´ ê´€ë¦¬ì APIì— ì ‘ê·¼í•œ ê²½ìš° 403 ì‘ë‹µì´ ë°œìƒí•˜ëŠ”ì§€ í™•ì¸

4. Security ì„¤ì •ì—ì„œ ê¶Œí•œ ë³„ URL ë³´í˜¸ê°€ ì‹¤ì œë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ê³  ë¬¸ì„œí™”


* JwtAuthenticationFilter

        // filter/JwtAuthenticationFilter.java
        package com.example.jwt.filter;

        import com.example.jwt.util.JwtUtil;
        import io.jsonwebtoken.Claims;
        import jakarta.servlet.*;
        import jakarta.servlet.http.*;
        import org.springframework.security.authentication.*;
        import org.springframework.security.core.context.SecurityContextHolder;
        import org.springframework.security.web.authentication.WebAuthenticationDetailsSource;
        import org.springframework.stereotype.Component;
        import org.springframework.web.filter.OncePerRequestFilter;

        import java.io.IOException;

        @Component
        public class JwtAuthenticationFilter extends OncePerRequestFilter {

            private final JwtUtil jwtUtil;

            public JwtAuthenticationFilter(JwtUtil jwtUtil) {
                this.jwtUtil = jwtUtil;
            }
        @Override
            protected void doFilterInternal(HttpServletRequest request,
                                            HttpServletResponse response,
                                            FilterChain filterChain)
                    throws ServletException, IOException {

                String header = request.getHeader("Authorization");
                if (header != null && header.startsWith("Bearer ")) {
                    String token = header.substring(7);
                    Claims claims = jwtUtil.validateToken(token);

                    if (claims != null) {
                        UsernamePasswordAuthenticationToken auth = new UsernamePasswordAuthenticationToken(
                                claims.getSubject(), null, null
                        );
                        auth.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));
                        SecurityContextHolder.getContext().setAuthentication(auth);
                    }
                }

                filterChain.doFilter(request, response);
            }
        }


* SecurityConfig ì„¤ì •

        // config/SecurityConfig.java
        package com.example.jwt.config;

        import com.example.jwt.filter.JwtAuthenticationFilter;
        import org.springframework.context.annotation.*;
        import org.springframework.security.authentication.*;
        import org.springframework.security.config.annotation.web.builders.HttpSecurity;
        import org.springframework.security.config.http.SessionCreationPolicy;
        import org.springframework.security.crypto.bcrypt.*;
        import org.springframework.security.web.*;
        import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;

        @Configuration
        public class SecurityConfig {

            private final JwtAuthenticationFilter jwtAuthenticationFilter;

            public SecurityConfig(JwtAuthenticationFilter jwtAuthenticationFilter) {
                this.jwtAuthenticationFilter = jwtAuthenticationFilter;
            }
        @Bean
            public PasswordEncoder passwordEncoder() {
                return new BCryptPasswordEncoder();
            }

            @Bean
            public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
                http.csrf().disable()
                    .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)
                    .and()
                    .authorizeHttpRequests()
                    .requestMatchers("/auth/**").permitAll()
                    .requestMatchers("/admin/**").hasRole("ADMIN")
                    .anyRequest().authenticated()
                    .and()
                    .addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class);

                return http.build();
            }
        }


* ì£¼ì˜ì‚¬í•­  
  
  DBì— ì €ì¥ë˜ëŠ” roleì€ ROLE_ADMIN  
  
  hasRole("ADMIN")ì€ ë‚´ë¶€ì ìœ¼ë¡œ ROLE_ prefixê°€ ë¶™ëŠ” ê²ƒì„ ê¸°ëŒ€í•¨  
> Talend í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤  
  
* ì‚¬ìš©ì ë“±ë¡ (ì¼ë°˜ ì‚¬ìš©ì)  
  
POST /auth/register  
{  
  "username": "user1",  
  "password": "pass1",  
  "role": "ROLE_USER"  
}  

  
* ê´€ë¦¬ì ë“±ë¡  
  
POST /auth/register  
{  
  "username": "admin1",  
  "password": "pass2",  
  "role": "ROLE_ADMIN"  
}  


* ë¡œê·¸ì¸ ìš”ì²­  
  
POST /auth/login  
{  
  "username": "admin1",  
  "password": "pass2"  
}  
  
âœ” ì‘ë‹µ: Bearer eyJhbGci...  


* ê´€ë¦¬ì í˜ì´ì§€ ìš”ì²­  
  
GET /admin/dashboard  
Authorization: Bearer {í† í°}  
  
user1 â†’ 403 Forbidden  
  
admin1 â†’ 200 OK, ë³¸ë¬¸: "ê´€ë¦¬ì í˜ì´ì§€ì…ë‹ˆë‹¤"  



> ìš”ì•½ ì •ë¦¬  
  
ì‚¬ìš©ì ë“±ë¡ ---> âœ” ì •ìƒ  
  
ë¡œê·¸ì¸ â†’ JWT ë°œê¸‰ ---> âœ” ì •ìƒ  
  
ê´€ë¦¬ì URI ë³´í˜¸ ---> âœ” ROLE_USER ì ‘ê·¼ ì‹œ ì°¨ë‹¨  
    
SecurityConfig ì‘ë™ ---> âœ” ê²½ë¡œë³„ ê¶Œí•œ ë™ì‘  
  
Talend í…ŒìŠ¤íŠ¸ ---> âœ” ì™„ë£Œ  
  


## Day 7 ê°ê´€ì‹ ë¬¸ì œ

1. Spring Securityì—ì„œ URLë§ˆë‹¤ ì ‘ê·¼ ê¶Œí•œì„ ì œì–´í•˜ë ¤ë©´ ì–´ë–¤ ì„¤ì • íŒŒì¼ì—ì„œ ì´ë¥¼ ì •ì˜í•˜ëŠ”ê°€? C
 A. application.properties  
 B. JwtUtil.java  
 C. SecurityConfig.java  
 D. WebConfig.java  
  
2. íšŒì›ê°€ì… ì‹œ ë¹„ë°€ë²ˆí˜¸ëŠ” ì–´ë–»ê²Œ ì €ì¥í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì•ˆì „í•œê°€? D  
 A. í‰ë¬¸ ê·¸ëŒ€ë¡œ ì €ì¥  
 B. MD5ë¡œ í•´ì‹œ  
 C. Base64 ì¸ì½”ë”©  
 D. BCryptë¡œ ì•”í˜¸í™”  
  
3. ì•„ë˜ ì¤‘ ROLE_ADMIN ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•œ URIëŠ”? C  
 A. /auth/login  
 B. /auth/register  
 C. /admin/dashboard  
 D. /user/profile  
  
4. Spring Securityì˜ hasRole("ADMIN") ì„¤ì •ì€ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–¤ ê¶Œí•œ ë¬¸ìì—´ì„ ê¸°ëŒ€í•˜ëŠ”ê°€? C  
 A. ADMIN  
 B. user:ADMIN  
 C. ROLE_ADMIN  
 D. /ADMIN  
  
5. JWT í† í°ì„ Authorization í—¤ë”ì— ë³´ë‚¼ ë•Œ ì‚¬ìš©í•˜ëŠ” ì ‘ë‘ì‚¬ëŠ”? C  
 A. Token  
 B. JWT  
 C. Bearer  
 D. Access  
  
6. SecurityFilterChainì—ì„œ ì¸ì¦ í•„í„°ë¥¼ ë“±ë¡í•  ë•Œ ì‚¬ìš©ë˜ëŠ” ë©”ì„œë“œëŠ”? B  
 A. addFilter  
 B. addFilterBefore  
 C. addAuthenticationFilter  
 D. addSecurityFilter  
  
7. ì‚¬ìš©ì ì¸ì¦ ì •ë³´ë¥¼ SecurityContextHolderì— ì €ì¥í•˜ë ¤ë©´ ì–´ë–¤ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì•¼ í•˜ëŠ”ê°€? B  
 A. UserDetails  
 B. UsernamePasswordAuthenticationToken  
 C. PrincipalDetails  
 D. AuthProvider  
  
8. ì•„ë˜ ì¤‘ JwtUtilì˜ ê¸°ëŠ¥ì´ ì•„ë‹Œ ê²ƒì€?D  
 A. í† í° ìƒì„±  
 B. í† í° ì„œëª…  
 C. í† í° ê²€ì¦  
 D. ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”  
  
9. JwtAuthenticationFilterëŠ” ì–´ë–¤ ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ ë™ì‘í•˜ëŠ”ê°€? B  
 A. doPost()  
 B. doFilterInternal()  
 C. run()  
 D. handleRequest()  
  
10. ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìê°€ /admin/dashboardì— ì ‘ê·¼í•˜ë©´ ë°œìƒí•˜ëŠ” HTTP ìƒíƒœ ì½”ë“œëŠ”? D  
 A. 401 Unauthorized  
 B. 200 OK  
 C. 500 Internal Server Error  
 D. 403 Forbidden  
  
11. SecurityFilterChainì—ì„œ /auth/** ê²½ë¡œì— ëŒ€í•´ .permitAll()ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ”? B  
 A. ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë§Œ ì ‘ê·¼í•˜ê²Œ í•˜ê¸° ìœ„í•´  
 B. ëˆ„êµ¬ë“  ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í—ˆìš©í•˜ê¸° ìœ„í•´  
 C. ê´€ë¦¬ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ í•˜ê¸° ìœ„í•´  
 D. ì¸ì¦ì´ í•„ìš” ì—†ìŒì„ ëª…ì‹œí•˜ê¸° ìœ„í•´  
  
12. Talend API í…ŒìŠ¤íŠ¸ì—ì„œ ROLE_USERë¡œ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ /admin/dashboardë¥¼ ìš”ì²­í•˜ë©´? B  
 A. 200 OK  
 B. 403 Forbidden  
 C. 404 Not Found  
 D. 302 Redirect  
  
13. JWT í† í°ì˜ claimì— ë“¤ì–´ê°€ëŠ” ì£¼ìš” ì •ë³´ëŠ” ë¬´ì—‡ì¸ê°€? C  
 A. ì‚¬ìš©ì ì•„ì´ë””, ì—­í• , ë¹„ë°€ë²ˆí˜¸  
 B. ìš”ì²­ URI  
 C. í† í°ì˜ subject, ë°œê¸‰ì¼, ë§Œë£Œì¼  
 D. ì‘ë‹µ ì½”ë“œ  
  
14. @PostMapping("/register")ê°€ ì˜ë¯¸í•˜ëŠ” ê²ƒì€? C  
 A. HTTP GET ìš”ì²­ ì²˜ë¦¬  
 B. HTML form ë Œë”ë§  
 C. HTTP POST ìš”ì²­ ì²˜ë¦¬  
 D. PUT ìš”ì²­ ì²˜ë¦¬  
  
15. ë‹¤ìŒ ì¤‘ ì¸ì¦ í•„í„°ë³´ë‹¤ ë¨¼ì € ë™ì‘í•˜ê²Œ ì„¤ì •í•˜ë ¤ë©´ ì–´ë–¤ í´ë˜ìŠ¤ë¥¼ ì•ì— ì¶”ê°€í•´ì•¼ í•˜ëŠ”ê°€? C  
 A. JwtUtil  
 B. PasswordEncoder  
 C. JwtAuthenticationFilter  
 D. SecurityContext  
  
16. ë¹„ë°€ë²ˆí˜¸ ë¹„êµ ì‹œ ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œëŠ”? C  
 A. encode()  
 B. match()  
 C. matches()  
 D. checkPassword()  
  
17. ì•„ë˜ ì½”ë“œ ì¤‘ ì¸ì¦ í•„í„° ë“±ë¡ ë°©ì‹ì€? C  
 A. .addFilter(jwtAuthenticationFilter)  
 B. .addFilterAfter(jwtAuthenticationFilter, ...)  
 C. .addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class)  
 D. .use(jwtAuthenticationFilter)  
  
18. ì‚¬ìš©ì ë“±ë¡ ì‹œ ì €ì¥ë˜ëŠ” ê¶Œí•œ(role)ì€ ì–´ë–¤ í˜•ì‹ì¸ê°€? C  
 A. ê·¸ëƒ¥ ADMIN  
 B. ADMIN_ROLE  
 C. ROLE_USER ë˜ëŠ” ROLE_ADMIN  
 D. USER/ADMIN  
  
19. JWTê°€ ìœ íš¨í•œì§€ ê²€ì¦í•˜ë ¤ë©´ ì–´ë–¤ í´ë˜ìŠ¤ê°€ í•„ìš”í• ê¹Œ? C  
 A. Claims  
 B. JwtTokenValidator  
 C. JwtUtil  
 D. JwtGenerator  
  
20. @RestControllerì˜ ì—­í• ì€? C  
 A. HTML ì‘ë‹µ ì œê³µ  
 B. Spring MVC View ë Œë”ë§  
 C. JSON/REST ì‘ë‹µ ì²˜ë¦¬  
 D. ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™ ì²˜ë¦¬  

## Day 7 ê°ê´€ì‹ ì •ë‹µ ë° í•´ì„¤
1. ë²ˆ ì •ë‹µ: C   
 SecurityConfig.javaì—ì„œ HttpSecurityë¥¼ í†µí•´ URL ì ‘ê·¼ ê¶Œí•œì„ ì„¤ì •í•©ë‹ˆë‹¤.
2. ì •ë‹µ: D  
 BCryptPasswordEncoderëŠ” Spring Securityì—ì„œ ì•ˆì „í•œ ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” ë°©ì‹ì…ë‹ˆë‹¤.  
3. ì •ë‹µ: C  
 /admin/dashboardëŠ” ê´€ë¦¬ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•œ URLì…ë‹ˆë‹¤.  
4. ì •ë‹µ: C  
 hasRole("ADMIN")ì€ ë‚´ë¶€ì ìœ¼ë¡œ ROLE_ADMINì„ ê¸°ëŒ€í•©ë‹ˆë‹¤.  
5. ì •ë‹µ: C  
 JWT í† í°ì€ Authorization: Bearer {í† í°} í˜•ì‹ìœ¼ë¡œ ì „ì†¡ë©ë‹ˆë‹¤.  
6. ì •ë‹µ: B  
 JWT ì¸ì¦ í•„í„°ëŠ” UsernamePasswordAuthenticationFilterë³´ë‹¤ ì•ì— ë“±ë¡í•´ì•¼ í•˜ë¯€ë¡œ addFilterBeforeë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.  
7. ì •ë‹µ: B  
 SecurityContextHolderì— ì¸ì¦ ì •ë³´ë¥¼ ì €ì¥í•˜ë ¤ë©´ UsernamePasswordAuthenticationTokenì„ ì‚¬ìš©í•©ë‹ˆë‹¤.  
8. ì •ë‹µ: D  
 ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”ëŠ” PasswordEncoderê°€ ë‹´ë‹¹í•˜ë©° JwtUtilì€ JWT ìƒì„± ë° ê²€ì¦ë§Œ í•©ë‹ˆë‹¤.  
9. ì •ë‹µ: B  
 JwtAuthenticationFilterëŠ” OncePerRequestFilterì˜ doFilterInternal()ì„ ì˜¤ë²„ë¼ì´ë“œí•©ë‹ˆë‹¤.  
10. ì •ë‹µ: D  
 ì¸ì¦ì€ ë˜ì—ˆì§€ë§Œ ê¶Œí•œì´ ë¶€ì¡±í•˜ë©´ 403 Forbiddenì´ ë°œìƒí•©ë‹ˆë‹¤.  
11. ì •ë‹µ: B  
 .permitAll()ì€ ëˆ„êµ¬ë“  ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ í—ˆìš©í•˜ëŠ” ì„¤ì •ì…ë‹ˆë‹¤.  
12.  ì •ë‹µ: B  
 ROLE_USER ê¶Œí•œìœ¼ë¡œ /admin/dashboardì— ì ‘ê·¼ ì‹œ 403 Forbiddenì´ ì‘ë‹µë©ë‹ˆë‹¤.  
13.  ì •ë‹µ: C  
 JWT Claimsì—ëŠ” ì‚¬ìš©ì ì´ë¦„, ë°œê¸‰ì¼(issuedAt), ë§Œë£Œì¼(expiration) ë“±ì˜ ì •ë³´ê°€ ë‹´ê¹ë‹ˆë‹¤.  
14. ì •ë‹µ: C  
 @PostMapping("/register")ëŠ” HTTP POST ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ì—”ë“œí¬ì¸íŠ¸ì…ë‹ˆë‹¤.  
15. ì •ë‹µ: C  
 JWT ì¸ì¦ í•„í„°ëŠ” UsernamePasswordAuthenticationFilterë³´ë‹¤ ì•ì— ì¶”ê°€í•´ì•¼ í•˜ë¯€ë¡œ   addFilterBefore()ë¡œ ë“±ë¡í•©ë‹ˆë‹¤.  
16. ì •ë‹µ: C  
 PasswordEncoder.matches()ë¥¼ í†µí•´ ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ì™€ ì…ë ¥ê°’ì„ ë¹„êµí•©ë‹ˆë‹¤.  
17. ì •ë‹µ: C  
 ì¸ì¦ í•„í„°ëŠ” addFilterBefore()ë¥¼ í†µí•´ ë“±ë¡í•˜ê³  ì¸ì¦ ìˆœì„œë¥¼ ì§€ì •í•©ë‹ˆë‹¤.  
18. ì •ë‹µ: C  
 Spring Securityì—ì„œëŠ” "ROLE_USER" ë˜ëŠ” "ROLE_ADMIN" í˜•ì‹ìœ¼ë¡œ ê¶Œí•œì„ ì €ì¥í•©ë‹ˆë‹¤.  
19. ì •ë‹µ: C  
 í† í° ìœ íš¨ì„± ê²€ì¦ì€ JwtUtil.validateToken() ë©”ì„œë“œì—ì„œ ìˆ˜í–‰ë©ë‹ˆë‹¤.  
20. ì •ë‹µ: C  
 @RestControllerëŠ” REST API ì‘ë‹µì„ JSON í˜•ì‹ìœ¼ë¡œ ë°˜í™˜í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì…ë‹ˆë‹¤.   



## Day 7 ë‹¨ë‹µí˜• ë¬¸ì œ

1. Spring Securityì—ì„œ URL ì ‘ê·¼ ê¶Œí•œì„ ì„¤ì •í•˜ëŠ” í´ë˜ìŠ¤ ì´ë¦„ì€?

2. ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•”í˜¸í™”í•  ë•Œ ì‚¬ìš©í•˜ëŠ” Spring Security í´ë˜ìŠ¤ëŠ”?

3. hasRole("ADMIN")ì´ ì¸ì‹í•˜ëŠ” ê¶Œí•œ ì´ë¦„ì€?

4. /admin/dashboard ê²½ë¡œì— ì ‘ê·¼ ê°€ëŠ¥í•œ ê¶Œí•œì€?

5. JWT í† í°ì„ HTTP ìš”ì²­ì— ë‹´ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” HTTP í—¤ë”ëŠ”?

6. JWT í† í° ì•ì— ë¶™ëŠ” ì ‘ë‘ì‚¬ëŠ”?

7. ì¸ì¦ì´ ì™„ë£Œëœ ì‚¬ìš©ì ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” Spring Securityì˜ ì»¨í…ìŠ¤íŠ¸ëŠ”?

8. ì‚¬ìš©ì ì¸ì¦ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í† í° í´ë˜ìŠ¤ ì´ë¦„ì€?

9. JwtAuthenticationFilterì—ì„œ í•„í„° ì²´ì¸ì— ì—°ê²°í•˜ê¸° ìœ„í•´ ì˜¤ë²„ë¼ì´ë“œí•˜ëŠ” ë©”ì„œë“œ ì´ë¦„ì€?

10. ë¡œê·¸ì¸ ìš”ì²­ ì‹œ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬ë˜ëŠ” ì‘ë‹µ ê°’ì€ ë¬´ì—‡ì¸ê°€?

11. ë¡œê·¸ì¸ ì„±ê³µ í›„ ë°œê¸‰ë˜ëŠ” ì¸ì¦ ìˆ˜ë‹¨ì€?

12. íšŒì›ê°€ì… APIì—ì„œ ì‚¬ìš©ìì˜ ê¶Œí•œ(ì—­í• )ì„ ì €ì¥í•˜ëŠ” í•„ë“œ ì´ë¦„ì€?

13. ì‚¬ìš©ìì˜ ê¶Œí•œì„ ì„¤ì •í•  ë•Œ ë°˜ë“œì‹œ í¬í•¨í•´ì•¼ í•˜ëŠ” ì ‘ë‘ì–´ëŠ”?

14. ê¶Œí•œì´ ì—†ëŠ” ì‚¬ìš©ìê°€ ê´€ë¦¬ì í˜ì´ì§€ì— ì ‘ê·¼í•  ê²½ìš° ë°œìƒí•˜ëŠ” HTTP ìƒíƒœ ì½”ë“œëŠ”?

15. ì‚¬ìš©ì ì¸ì¦ í•„í„°ëŠ” ì–´ë–¤ ê¸°ë³¸ í•„í„°ë³´ë‹¤ ë¨¼ì € ë“±ë¡ë˜ì–´ì•¼ í•˜ëŠ”ê°€?

16. ì‚¬ìš©ì ì¸ì¦ í›„ ì¸ì¦ ê°ì²´ë¥¼ ë“±ë¡í•˜ëŠ” ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ í´ë˜ìŠ¤ëŠ”?

17. í† í°ì´ ìœ íš¨í•œì§€ë¥¼ ê²€ì‚¬í•˜ëŠ” JwtUtil ë©”ì„œë“œì˜ ì´ë¦„ì€?

18. Security ì„¤ì •ì—ì„œ ì¸ì¦ ì—†ì´ ì ‘ê·¼ì„ í—ˆìš©í•˜ëŠ” ë©”ì„œë“œëŠ”?

19. JWT í† í°ì˜ ë‚´ë¶€ ì •ë³´(Claims)ì—ì„œ ì‚¬ìš©ìì˜ ì´ë¦„ì„ ì €ì¥í•˜ëŠ” í•„ë“œëŠ”?

20. Spring Bootì—ì„œ REST API ì‘ë‹µì„ JSONìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ ì–´ë…¸í…Œì´ì…˜ì€?

## Day 7 ë‹¨ë‹µí˜• ë¬¸ì œ ì •ë‹µ + í•´ì„¤

1. ì •ë‹µ: SecurityConfig.java
 â†’ Spring Securityì—ì„œ URL ì ‘ê·¼ ê¶Œí•œ ì„¤ì •ì€ HttpSecurity ê°ì²´ë¥¼ ì„¤ì •í•˜ëŠ” SecurityConfig í´ë˜ìŠ¤ì—ì„œ í•©ë‹ˆë‹¤.
2. ì •ë‹µ: BCryptPasswordEncoder
 â†’ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•ˆì „í•˜ê²Œ ì•”í˜¸í™”í•˜ê¸° ìœ„í•´ Spring Securityì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” í´ë˜ìŠ¤ì…ë‹ˆë‹¤.
3. ì •ë‹µ: ROLE_ADMIN
 â†’ hasRole("ADMIN")ì€ ë‚´ë¶€ì ìœ¼ë¡œ ROLE_ADMINì´ë¼ëŠ” ë¬¸ìì—´ì„ ì‚¬ìš©í•´ ê¶Œí•œì„ ê²€ì‚¬í•©ë‹ˆë‹¤.
4. ì •ë‹µ: ROLE_ADMIN
 â†’ /admin/** ê²½ë¡œëŠ” ê´€ë¦¬ì ê¶Œí•œì„ ê°€ì§„ ì‚¬ìš©ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •ë©ë‹ˆë‹¤.
5. ì •ë‹µ: Authorization
 â†’ JWT í† í°ì€ HTTP í—¤ë” ì¤‘ Authorizationì— í¬í•¨ë˜ì–´ ì„œë²„ë¡œ ì „ì†¡ë©ë‹ˆë‹¤.
6. ì •ë‹µ: Bearer
 â†’ JWT í† í°ì€ "Bearer " ì ‘ë‘ì–´ì™€ í•¨ê»˜ ì „ì†¡ë©ë‹ˆë‹¤. (Bearer {token} í˜•ì‹)
7. ì •ë‹µ: SecurityContextHolder
 â†’ ì¸ì¦ëœ ì‚¬ìš©ì ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” Spring Securityì˜ ì „ì—­ ì»¨í…ìŠ¤íŠ¸ì…ë‹ˆë‹¤.
8. ì •ë‹µ: UsernamePasswordAuthenticationToken
 â†’ ì¸ì¦ì´ ì™„ë£Œëœ ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ë‹´ì•„ SecurityContextì— ë“±ë¡í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ì¸ì¦ ê°ì²´ì…ë‹ˆë‹¤.
9. ì •ë‹µ: doFilterInternal
 â†’ JWT í•„í„° í´ë˜ìŠ¤ëŠ” OncePerRequestFilterë¥¼ ìƒì†í•˜ê³  ì´ ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œí•´ ë™ì‘í•©ë‹ˆë‹¤.
10. ì •ë‹µ: JWT í† í°
 â†’ ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ì„œë²„ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ê²Œ JWT í† í°ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
11. ì •ë‹µ: JWT
 â†’ JWTëŠ” ë¡œê·¸ì¸ ì´í›„ API ì ‘ê·¼ì„ ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì¸ì¦ í† í°ì…ë‹ˆë‹¤.
12. ì •ë‹µ: role
 â†’ íšŒì›ê°€ì… ì‹œ ìš”ì²­ DTOì— í¬í•¨ë˜ëŠ” í•„ë“œë¡œ ì‚¬ìš©ì ê¶Œí•œì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì˜ˆ: ROLE_USER, ROLE_ADMIN
13. ì •ë‹µ: ROLE_
 â†’ Spring SecurityëŠ” ê¶Œí•œëª… ì•ì— "ROLE_"ì´ ë¶™ì–´ ìˆì–´ì•¼ ì¸ì‹í•©ë‹ˆë‹¤.
14. ì •ë‹µ: 403
 â†’ ì¸ì¦ì€ ë˜ì—ˆì§€ë§Œ ê¶Œí•œì´ ë¶€ì¡±í•œ ê²½ìš° 403 Forbidden ìƒíƒœ ì½”ë“œê°€ ì‘ë‹µë©ë‹ˆë‹¤.
15. ì •ë‹µ: UsernamePasswordAuthenticationFilter
 â†’ JWT ì¸ì¦ í•„í„°ëŠ” ì´ í•„í„°ë³´ë‹¤ ë¨¼ì € ë™ì‘í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— addFilterBefore()ë¡œ ë“±ë¡í•©ë‹ˆë‹¤.
16. ì •ë‹µ: SecurityContextHolder
 â†’ ì¸ì¦ ê°ì²´ëŠ” ì´ ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥ë˜ì–´ ì „ì—­ì ìœ¼ë¡œ ì°¸ì¡°ë©ë‹ˆë‹¤.
17. ì •ë‹µ: validateToken
 â†’ JwtUtil í´ë˜ìŠ¤ì—ì„œ í† í°ì˜ ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ëŠ” ë©”ì„œë“œì…ë‹ˆë‹¤.
18. ì •ë‹µ: permitAll
 â†’ ì¸ì¦ ì—†ì´ ì ‘ê·¼ì„ í—ˆìš©í•  URL íŒ¨í„´ì— ì´ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
19. ì •ë‹µ: sub
 â†’ JWT Claims ë‚´ì— ì‚¬ìš©ì ì‹ë³„ìëŠ” ì¼ë°˜ì ìœ¼ë¡œ subject(sub) í•„ë“œì— ì €ì¥ë©ë‹ˆë‹¤.
20. ì •ë‹µ: @RestController
 â†’ ì´ ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ JSON í˜•ì‹ì˜ REST API ì‘ë‹µì´ ê¸°ë³¸ìœ¼ë¡œ ì œê³µë©ë‹ˆë‹¤.



 ## Day 7 í”„ë¡œê·¸ë¨ ì‹¤ìŠµí˜• ë¬¸ì œ 10ë¬¸ì œ

ë¬¸ì œ 1   
User ì—”í‹°í‹° í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•˜ì„¸ìš”.   
username, password, role í•„ë“œë¥¼ í¬í•¨í•˜ê³    
   
@Entity, @Id, @GeneratedValue ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ JPA ë§¤í•‘ì„ ì™„ë£Œí•˜ì„¸ìš”.   
   
   
   
ë¬¸ì œ 2   
UserRepository ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‘ì„±í•˜ê³ ,   
 findByUsername(String username) ë©”ì„œë“œë¥¼ ì„ ì–¸í•˜ì„¸ìš”.   
   
ë¬¸ì œ 3   
RegisterRequest DTOë¥¼ ìƒì„±í•˜ê³    
 username, password, role í•„ë“œë¥¼ ì •ì˜í•˜ì„¸ìš”.   
   
ë¬¸ì œ 4   
AuthControllerì— /auth/register POST ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ë©”ì„œë“œë¥¼ ì¶”ê°€í•˜ì„¸ìš”.   
ìš”ì²­ ë°›ì€ ì‚¬ìš©ì ì •ë³´ë¥¼ ì €ì¥í•˜ê³    
   
   
ë¹„ë°€ë²ˆí˜¸ëŠ” BCryptPasswordEncoderë¥¼ ì‚¬ìš©í•˜ì—¬ ì•”í˜¸í™”í•œ ë’¤ ì €ì¥í•˜ì„¸ìš”.   


ë¬¸ì œ 5
SecurityConfig í´ë˜ìŠ¤ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ê²½ë¡œë³„ ì ‘ê·¼ ê¶Œí•œì„ ì„¤ì •í•˜ì„¸ìš”.   
/auth/**ëŠ” ëª¨ë‘ í—ˆìš©   
   
   
/admin/**ì€ ROLE_ADMINë§Œ í—ˆìš©   
   
   
ë‚˜ë¨¸ì§€ ìš”ì²­ì€ ì¸ì¦ëœ ì‚¬ìš©ìë§Œ í—ˆìš©   
   
   
   
ë¬¸ì œ 6   
Talend API Testerë¥¼ ì´ìš©í•˜ì—¬ ë‹¤ìŒ JSONìœ¼ë¡œ ì¼ë°˜ ì‚¬ìš©ì ê³„ì •ì„ ë“±ë¡í•´ë³´ì„¸ìš”.   
{   
  "username": "user1",   
  "password": "pass1",   
  "role": "ROLE_USER"   
}   
   
   
ë¬¸ì œ 7   
Talendë¥¼ ì´ìš©í•´ ê´€ë¦¬ì ê³„ì •ì„ ë“±ë¡í•´ë³´ì„¸ìš”.   
{   
  "username": "admin1",   
  "password": "pass2",   
  "role": "ROLE_ADMIN"   
}   


ë¬¸ì œ 8   
/auth/login ìš”ì²­ì„ í†µí•´ ìœ„ ë‘ ê³„ì •ì— ëŒ€í•´ JWT í† í°ì„ ë°œê¸‰ë°›ê³ ,   
 Authorization: Bearer {í† í°}ì„ í—¤ë”ì— í¬í•¨í•˜ì—¬ ë‹¤ìŒ ìš”ì²­ì„ ê°ê° ì‹œë„í•˜ì„¸ìš”:   
URL: /admin/dashboard   

   
ì‚¬ìš©ì: user1 â†’ ì‘ë‹µì´ 403ì¸ì§€ í™•ì¸   
   

ì‚¬ìš©ì: admin1 â†’ ì‘ë‹µì´ 200ì´ê³  "ê´€ë¦¬ì í˜ì´ì§€ì…ë‹ˆë‹¤"ê°€ ë°˜í™˜ë˜ëŠ”ì§€ í™•ì¸   
   


ë¬¸ì œ 9   
Security ì„¤ì •ì—ì„œ hasRole("ADMIN")ìœ¼ë¡œ ì„¤ì •í–ˆì„ ë•Œ,   
 ê¶Œí•œ í•„ë“œê°€ "ROLE_ADMIN"ìœ¼ë¡œ ì €ì¥ë¼ì•¼ í•˜ëŠ” ì´ìœ ë¥¼ ì„¤ëª…í•´ë³´ì„¸ìš”.   
      
    

ë¬¸ì œ 10   
ìœ„ ì‹¤ìŠµì„ ì •ë¦¬í•œ ë³´ê³ ì„œë¥¼ ì‘ì„±í•˜ì„¸ìš”.   
ë“±ë¡ëœ ì‚¬ìš©ì ëª©ë¡   
   
JWT ì‘ë‹µê³¼ ê¶Œí•œ í™•ì¸ ìŠ¤í¬ë¦°ìƒ·   

   
403 ì‘ë‹µ ìº¡ì²˜   

   
Security ì„¤ì • íŒŒì¼ ì½”ë“œ ì¼ë¶€ í¬í•¨   


## Day 7 ë¬¸ì œ í’€ì´

ë¬¸ì œ 1
User ì—”í‹°í‹° í´ë˜ìŠ¤ ì‘ì„±
        package com.example.jwt.model;

        import jakarta.persistence.*;

        @Entity
        public class User {

            @Id
            @GeneratedValue(strategy = GenerationType.IDENTITY)
            private Long id;

            private String username;
            private String password;
            private String role; // ROLE_USER ë˜ëŠ” ROLE_ADMIN

            // Getters & Setters
        }


ë¬¸ì œ 2
UserRepository ì¸í„°í˜ì´ìŠ¤ ì‘ì„±
        package com.example.jwt.repository;

        import com.example.jwt.model.User;
        import org.springframework.data.jpa.repository.JpaRepository;

        import java.util.Optional;

        public interface UserRepository extends JpaRepository<User, Long> {
            Optional<User> findByUsername(String username);
        }

ë¬¸ì œ 3
RegisterRequest DTO ìƒì„±

        package com.example.jwt.dto;

        public class RegisterRequest {
            private String username;
            private String password;
            private String role;

            // Getters & Setters
        }


ë¬¸ì œ 4
íšŒì›ê°€ì… API (/auth/register) êµ¬í˜„

        @PostMapping("/register")
        public ResponseEntity<?> register(@RequestBody RegisterRequest request) {
            String encodedPassword = passwordEncoder.encode(request.getPassword());

            User user = new User();
            user.setUsername(request.getUsername());
            user.setPassword(encodedPassword);
            user.setRole(request.getRole());

            userRepository.save(user);

            return ResponseEntity.ok("íšŒì›ê°€ì… ì™„ë£Œ");
        }

--> passwordEncoderëŠ” BCryptPasswordEncoder ë¹ˆìœ¼ë¡œ ì£¼ì…ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

ë¬¸ì œ 5
SecurityConfigì—ì„œ ê¶Œí•œë³„ ì ‘ê·¼ ì„¤ì •

        @Bean
        public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
            http.csrf().disable()
                .authorizeHttpRequests()
                .requestMatchers("/auth/**").permitAll()
                .requestMatchers("/admin/**").hasRole("ADMIN")
                .anyRequest().authenticated()
                .and()
                .addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class);

            return http.build();
        }   
   
hasRole("ADMIN")ì€ ë‚´ë¶€ì ìœ¼ë¡œ ROLE_ ì ‘ë‘ì‚¬ê°€ ë¶™ìœ¼ë¯€ë¡œ, ë°ì´í„°ì—ëŠ” "ROLE_ADMIN"ìœ¼ë¡œ ì €ì¥í•´ì•¼ í•©ë‹ˆë‹¤.   
   

ë¬¸ì œ 6   
Talendë¡œ ì¼ë°˜ ì‚¬ìš©ì ë“±ë¡   
        Method: POST   
   
        URL: http://localhost:8080/auth/register   
   
        Body:   
   
        {   
          "username": "user1",   
          "password": "pass1",   
          "role": "ROLE_USER"   
        }   
   
        âœ” ì‘ë‹µ: "íšŒì›ê°€ì… ì™„ë£Œ"   
   
   
ë¬¸ì œ 7   
Talendë¡œ ê´€ë¦¬ì ê³„ì • ë“±ë¡   
        Method: POST   
   
        Body:   
   
        {   
          "username": "admin1",   
          "password": "pass2",   
          "role": "ROLE_ADMIN"   
        }   
   
        âœ” ì‘ë‹µ: "íšŒì›ê°€ì… ì™„ë£Œ"   



ë¬¸ì œ 8
JWT í† í° ë°œê¸‰ ë° ê¶Œí•œë³„ ìš”ì²­ í…ŒìŠ¤íŠ¸   
        ë¡œê·¸ì¸ /auth/login      
   
        {   
          "username": "user1",   
          "password": "pass1"   
        }   

        â†’ ì‘ë‹µ: "Bearer eyJhbGciOi..."   
        ê´€ë¦¬ì ìš”ì²­ /admin/dashboard   
   
        Header:
      
        Authorization: Bearer {í† í°}   

        user1 ìš”ì²­ ê²°ê³¼: 403 Forbidden   
   
        admin1 ìš”ì²­ ê²°ê³¼: 200 OK, ì‘ë‹µ ë³¸ë¬¸: "ê´€ë¦¬ì í˜ì´ì§€ì…ë‹ˆë‹¤"   


ë¬¸ì œ 9   
        hasRole("ADMIN") vs ROLE_ADMIN ì„¤ëª…   
        Spring Securityì˜ hasRole("ADMIN")ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ROLE_ ì ‘ë‘ì‚¬ë¥¼ ìë™ìœ¼ë¡œ ë¶™ì—¬ì„œ "ROLE_ADMIN"ê³¼ ë¹„êµí•©ë‹ˆë‹¤.   
   

        ê·¸ë˜ì„œ DBì—ëŠ” ROLE_ADMIN í˜•ì‹ìœ¼ë¡œ ì €ì¥ë˜ì–´ì•¼ hasRole("ADMIN")ë¡œ ê²€ì¦ì´ ë©ë‹ˆë‹¤.   
   
   
   
ë¬¸ì œ 10   
ì •ë¦¬ ë³´ê³ ì„œ ì˜ˆì‹œ   
ì‚¬ìš©ì ëª©ë¡   
   
        user1 (ROLE_USER)   
   
        admin1 (ROLE_ADMIN)   
   
        JWT ì‘ë‹µ ìº¡ì²˜   
   
        sub, iat, exp í¬í•¨ëœ í† í°   
   
        403 ì‘ë‹µ ìŠ¤í¬ë¦°ìƒ·   
   
        user1 â†’ /admin/dashboard ìš”ì²­ ì‹œ ì°¨ë‹¨ë¨   
   
        ì½”ë“œ ìŠ¤ë‹ˆí«   
   
        .requestMatchers("/admin/**").hasRole("ADMIN")   



